<!DOCTYPE html>
<html lang="en">
<head>
    <!--links to styleheet and link of search bar icon-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=search" />
    <link rel="icon" href="/static/KDC LOGO.png" type="image/png">
</head>
<!-- navigation bar for the menu links to different pages including the search bar-->
<body>
    <div class="header">
        <div class="header-left">
            <a href="{{url_for('index')}}" class="logo"><img src="{{ url_for('static', filename='KDC LOGO.png') }}" class="KDC-logo"></a>
            <a href="{{url_for('index')}}" span>üè†</span> <span> Home</span> </a></a>
        </div>
        <div class="header-menu">
            <h1 class="header-title">Kendricks Chicken</h1>
        </div>

        <form action="{{ url_for('menu') }}" method="get" class="search-form">
            <div class="search">
                <span class="material-symbols-outlined">search</span>
                <input class="search-input" 
                       type="search" 
                       name="search"
                       placeholder="Search" 
                       value="{{ search_query or '' }}"
                       autocomplete="off">
            </div>
        </form>
        
        <div class="header-right">
            <!-- Cart with Dropdown -->
            <div class="cart-container">
                <a href="" class="cart-button" span> üõí </span> <span> Cart</span> </a></a>
                <div class="cart-dropdown">
                    <ul class="cart-items-list">
                        <!-- Dynamically populate cart items here -->
                        {% if cart_items %}
                            {% for item in cart_items %}
                                <li class="cart-item">
                                    <img src="{{ url_for('static', filename=item['image_url']) }}" alt="{{ item['name'] }}">
                                    <span>{{ item['name'] }}</span>
                                    <span class="cart-item-price">${{ "%.2f"|format(item['price']|float) }}</span>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li class="cart-empty-message">Your cart is empty.</li>
                        {% endif %}
                    </ul>
                    <a href="{{url_for('checkout')}}" class="checkout-button">Go to Checkout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Results Info -->
    {% if search_query %}
        <div class="search-info">
            {% if menu_items %}
                <p>Found {{ menu_items|length }} result(s) for "<strong>{{ search_query }}</strong>"</p>
                <a href="{{ url_for('menu') }}" class="clear-search">Clear search</a>
            {% else %}
                <div class="no-results">
                    <h3>No menu items found for "{{ search_query }}"</h3>
                    <p>Try searching for "wings", "classic", "feast", or "japanese"</p>
                    <a href="{{ url_for('menu') }}" class="clear-search-button">View All Items</a>
                </div>
            {% endif %}
        </div>
    {% endif %}

    <div class="menu">
        {% if menu_items %}
            {% for item in menu_items %}
                <div class="menu-item" data-id="{{ item.id }}">
                    <h1>{{ item.name }}</h1>
                    <img src="{{ item.image }}" alt="{{ item.name }}" class="menu-item-image">
                    <h2>{{ item.subtitle }}</h2>
                    <p class="price">${{ "%.2f"|format(item.price) }}</p>
                    <p>{{ item.description }}</p>
                    <form action="{{ url_for('add_to_cart') }}" method="post">
                        <input type="hidden" name="item_id" value="{{ item.id }}">
                        <!-- Preserve search query when adding to cart -->
                        <input type="hidden" name="search_query" value="{{ search_query or '' }}">
                        <button type="submit" class="button-buy">Add</button>
                    </form>
                </div>
            {% endfor %}
        {% endif %}
    </div>
</body>
</html>